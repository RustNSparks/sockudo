# Test ARM64/aarch64 musl binary
FROM --platform=linux/arm64 alpine:3.19

# Alpine already has musl, just need certificates
RUN apk add --no-cache ca-certificates

# Copy and extract the binary from tgz
COPY sockudo-aarch64-unknown-linux-musl.tgz /tmp/
RUN tar -xzf /tmp/sockudo-aarch64-unknown-linux-musl.tgz -C /usr/local/bin/ && \
    rm /tmp/sockudo-aarch64-unknown-linux-musl.tgz

# Make it executable
RUN chmod +x /usr/local/bin/sockudo

# Test the binary
CMD ["/usr/local/bin/sockudo", "--version"]